(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fb6c3b0"],{4269:function(t,n,e){"use strict";(function(t){e("96cf");var a=e("1da1"),r=e("70b0"),o=e.n(r),i=e("7a94");function c(t){return new Promise((function(n,e){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){return n(a.result)},a.onerror=function(t){return e(t)}}))}n["a"]={data:function(){return{dataArr:[],picUrl:e("52a0"),visibleMenu:!1,emoteList:["🌸","❄","🌺","❄","🍂","❄","🍀","❄","🍃","❄"],innerW:100,innerH:100,picUrlBG:"",picUrlMB:"",flowerShow:!1,canvasA:null}},created:function(){this.setInnerSize()},methods:{createImage:function(){var t=document.getElementById("indexPage"),n=this;o.a.toPng(t).then((function(t){n.saveUrl=t;var e=document.createElement("a"),a=new MouseEvent("click");e.download=name||"截图名称",e.href=n.saveUrl,e.dispatchEvent(a)})).catch((function(t){console.error("生成失败",t)}))},showFlower:function(){this.flowerShow=!this.flowerShow,t("#fallFlowerArea").toggle()},handleChangeTp:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(n,e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("error"!==n.file.status){t.next=5;break}return t.next=3,c(n.file.originFileObj);case 3:this.picUrl=t.sent,"BG"===e?(this.picUrlBG=this.picUrl,this.debounce(this.setCanvasPicBG(),2e3,!1)):(this.picUrlMB=this.picUrl,this.debounce(this.setCanvasPicMB(),2e3,!1));case 5:case"end":return t.stop()}}),t,this)})));function n(n,e){return t.apply(this,arguments)}return n}(),showDrawer:function(){this.visibleMenu=!0},onClose:function(){this.visibleMenu=!1},setInnerSize:function(){this.innerW=window.innerWidth,this.innerH=window.innerHeight},createEmoteElement:function(){var n=40,e=10+Math.round(Math.random()*n),a=Math.round(Math.random()*this.innerW),r=Math.round(50*Math.random()),o=((34*Math.random()+66)/100).toFixed(1)-0,i=3e3+Math.round(2e3*Math.random()),c=t("<div></div>").css({position:"absolute",color:"#fff",top:"".concat(r,"px"),left:"".concat(a,"px"),fontSize:"".concat(e,"px"),opacity:o,zIndex:9999,textShadow:"0 0 ".concat(e/3,"px #ffffffcc"),transition:"transform ".concat(i,"ms linear")}).html(this.emoteList[Math.round(Math.random()*(this.emoteList.length-1))]);return{emoteEl:c,emoteParams:{fs:e,left:a,top:r,opacity:o,transitionDuration:i}}},setEmoteAnimate:function(){var n=this.createEmoteElement(),e=n.emoteEl,a=n.emoteParams;t("#fallFlowerArea").append(e);var r=[-200,200],o=a.left+r[Math.round(Math.random())],i=this.innerH-Math.round(66*Math.random()),c=10*this.innerH+Math.round(4e3*Math.random()),s=1-((Math.round(4*Math.random())/10).toFixed(2)-0),l=1200+Math.round(2e3*Math.random());e.animate({left:"".concat(o,"px"),top:"".concat(i,"px")},c,"linear",(function(){e.css({transform:"scale(".concat(s,")")}).animate({opacity:0},l,"linear",(function(){return e.remove()}))}))},startFallFlower:function(){var t=0,n=this;setInterval((function(){t%10===0&&n.setInnerSize(),t+=1,n.setEmoteAnimate()}),4e3)},debounce:function(t,n,e){var a,r,o,i,c,s=function s(){var l=(new Date).getTime()-i;l<n&&l>=0?a=setTimeout(s,n-l):(a=null,e||(c=t.apply(o,r),a||(o=r=null)))};return function(){o=this,r=arguments,i=(new Date).getTime();var l=e&&!a;return a||(a=setTimeout(s,n)),l&&(c=t.apply(o,r),o=r=null),c}},setCanvasPicBG:function(){var t=this.canvasA||new i["fabric"].Canvas("canvasA");this.canvasA=t;var n=this.picUrlBG;i["fabric"].Image.fromURL(n,(function(e){t.setBackgroundImage(n,t.renderAll.bind(t),{scaleX:t.width/e.width,scaleY:t.height/e.height})}))},setCanvasPicMB:function(){var t=this.canvasA||new i["fabric"].Canvas("canvasA");this.canvasA=t;var n=this.picUrlMB;i["fabric"].Image.fromURL(n,(function(n){n.scale(.4),t.add(n)}))},addText:function(){var t=this.canvasA||new i["fabric"].Canvas("canvasA");this.canvasA=t;var n=new i["fabric"].IText("类型",{top:200,left:240,fontSize:55,backgroundColor:"",fill:"#f3ec37",stroke:"#f6416c",strokeWidth:0,strokeDashArray:[20,5,14],shadow:"10px 20px 6px rgba(10, 20, 30, 0.1)",transparentCorners:!1,borderColor:"#16f1fc",borderScaleFactor:0,borderDashArray:[20,5,10,7],cornerColor:"#a1de93",cornerStrokeColor:"pink",cornerStyle:"circle",cornerSize:20,cornerDashArray:[10,2,6],selectionBackgroundColor:"#7f1300",padding:0,borderOpacityWhenMoving:.6});t.add(n)},addTextAdvan:function(){var t=this.canvasA||new i["fabric"].Canvas("canvasA");this.canvasA=t;var n=new i["fabric"].IText("一口气看完系列\n\n        已完结\n\n     类型+重生",{top:100,left:100,fontSize:55,backgroundColor:"",fill:"yellow",stroke:"#f6416c",strokeWidth:0,strokeDashArray:[20,5,14],shadow:"10px 20px 6px rgba(10, 20, 30, 0.1)",transparentCorners:!1,borderColor:"#16f1fc",borderScaleFactor:0,borderDashArray:[20,5,10,7],cornerColor:"#a1de93",cornerStrokeColor:"pink",cornerStyle:"circle",cornerSize:20,cornerDashArray:[10,2,6],selectionBackgroundColor:"#7f1300",padding:0,borderOpacityWhenMoving:.6});t.add(n)}}}}).call(this,e("1157"))},bd57:function(t,n,e){"use strict";e("d465")},d465:function(t,n,e){},e742:function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t._self._c;return n("div",[n("div",[t._m(0),n("div",{staticClass:"menu"},[n("a-button",{on:{click:t.showDrawer}},[t._v("菜单")])],1),n("a-drawer",{attrs:{title:"编辑菜单",placement:"bottom",closable:!1,visible:t.visibleMenu},on:{close:t.onClose}},[n("p",[n("a-upload",{attrs:{name:"file",multiple:!1,action:""},on:{change:function(n){return t.handleChangeTp(n,"BG")}}},[n("div",[n("a-button",{staticClass:"ant-upload-text"},[t._v("\n              上传背景图\n            ")])],1)])],1),n("p",[n("a-upload",{attrs:{name:"file",multiple:!1,action:""},on:{change:function(n){return t.handleChangeTp(n,"MB")}}},[n("div",[n("a-button",{staticClass:"ant-upload-text"},[t._v("\n              上传主体图\n            ")])],1)])],1),n("p",[n("a-button",{class:{red:t.flowerShow},on:{click:t.showFlower}},[t._v("落花区域")])],1),n("p",[n("a-button",{on:{click:t.addTextAdvan}},[t._v("小说预设文字")])],1),n("p",[n("a-button",{on:{click:t.addText}},[t._v("添加文字")])],1),n("p",[n("a-button",{staticClass:"vam",attrs:{size:"large"},on:{click:t.createImage}},[t._v("\n          保存图片\n        ")])],1)])],1)])},r=[function(){var t=this,n=t._self._c;return n("div",{attrs:{id:"indexPage"}},[n("div",{attrs:{id:"container"}},[n("canvas",{staticStyle:{border:"1px solid #ccc"},attrs:{width:"800",height:"480",id:"canvasA"}})]),n("div",{staticClass:"fallFlowerArea",staticStyle:{display:"none"},attrs:{id:"fallFlowerArea"}})])}],o=e("4269"),i=o["a"],c=(e("bd57"),e("2877")),s=Object(c["a"])(i,a,r,!1,null,null,null);n["default"]=s.exports}}]);